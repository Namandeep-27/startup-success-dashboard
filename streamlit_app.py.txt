import streamlit as st
import pandas as pd
import altair as alt

# Title and intro
st.title("🚀 Startup Success Prediction Dashboard")
st.markdown("""
This tool predicts whether a startup is likely to succeed based on early-stage features like funding, milestones, and investor signals.

**Instructions:**
- Use the dropdown to select a startup
- View its predicted success/failure and probability
- Explore all predictions in the table below

*Built using XGBoost and SHAP — Project by Namandeep Singh Nayyar.*
""")

# Load predictions file
@st.cache_data
def load_data():
    df = pd.read_csv("startup_predictions.csv")
    return df

df = load_data()

# Dropdown to select a startup
startup_names = df["name"].dropna().unique()
selected_name = st.selectbox("🔍 Select a Startup to View Prediction", sorted(startup_names))

# Show prediction details
if selected_name:
    selected_row = df[df["name"] == selected_name].iloc[0]
    st.subheader(f"🔢 Prediction for: {selected_row['name']}")
    st.metric("Success Probability", f"{selected_row['success_probability']:.2%}")
    st.metric("Predicted Outcome", "Success" if selected_row['predicted_success'] == 1 else "Failure")

# Show full table with filter
st.markdown("---")
st.subheader("📊 All Predictions")
st.dataframe(df[["name", "success_probability", "predicted_success"]].sort_values(by="success_probability", ascending=False))

# Download option
csv = df.to_csv(index=False)
st.download_button("📥 Download Predictions as CSV", csv, "startup_predictions.csv", "text/csv")